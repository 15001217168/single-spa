{"version":3,"sources":["../src/single-spa.js"],"names":[],"mappings":"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","file":"single-spa.js","sourcesContent":["let appLocationToApp = {};\nlet unhandledRouteHandlers = [];\nlet mountedApp;\nconst nativeAddEventListener = window.addEventListener;\n\nwindow.singlespa = {};\nwindow.singlespa.prependUrl = prependUrl;\nwindow.singlespa.loader = window.System; //hard dependency on JSPM being on the page\n\nfunction prependUrl(prefix, url) {\n    if (!url.startsWith('/')) {\n        //relative urls are taken care of by the <base> tag\n        return url;\n    }\n    let parsedURL = document.createElement('a');\n    parsedURL.href = url;\n    if (parsedURL.host === window.location.host && !parsedURL.pathname.startsWith(url)) {\n        return `${parsedURL.protocol}//` + `${parsedURL.hostname}:${parsedURL.port}/${prefix}/${parsedURL.pathname}${parsedURL.search}${parsedURL.hash}`.replace(/[\\/]+/g, '/');\n    } else {\n        return url;\n    }\n}\n\nexport function declareChildApplication(appLocation, activeWhen) {\n    if (typeof appLocation !== 'string' || appLocation.length === 0)\n        throw new Error(`The first argument must be a non-empty string 'appLocation'`);\n    if (typeof activeWhen !== 'function')\n        throw new Error(`The second argument must be a function 'activeWhen'`);\n    if (appLocationToApp[appLocation])\n        throw new Error(`There is already an app declared at location ${appLocation}`);\n\n    appLocationToApp[appLocation] = {\n        appLocation: appLocation,\n        activeWhen: activeWhen,\n        parentApp: mountedApp ? mountedApp.appLocation : null\n    };\n\n    triggerAppChange(true);\n}\n\nexport function addUnhandledRouteHandler(handler) {\n    if (typeof handler !== 'function') {\n        throw new Error(`The first argument must be a handler function`);\n    }\n    unhandledRouteHandlers.push(handler);\n}\n\nexport function updateApplicationSourceCode(appName) {\n    if (!appLocationToApp[appName]) {\n        throw new Error(`No such app '${appName}'`);\n    }\n    let app = appLocationToApp[appName];\n    app.lifecycleFunctions.activeApplicationSourceWillUpdate()\n    .then((resolve) => {\n        //TODO reload the app\n        resolve()\n    })\n    .then(app.lifecycleFunctions.activeApplicationSourceWasUpdated);\n}\n\nfunction callLifecycleFunction(app, funcName, ...args) {\n    return new Promise((resolve) => {\n        if (app.lifecycles.length > 0) {\n            callFunc(0);\n        } else {\n            //nothing to do\n            resolve();\n        }\n        function callFunc(i) {\n            let funcPromise;\n            if (app.lifecycles[i][funcName]) {\n                funcPromise = app.lifecycles[i][funcName](...args);\n            } else {\n                funcPromise = new Promise((resolve) => resolve());\n            }\n            funcPromise\n            .then(() => {\n                if (i === app.lifecycles.length - 1) {\n                    resolve();\n                } else {\n                    callFunc(++i);\n                }\n            })\n            .catch((ex) => {\n                throw ex;\n            });\n        }\n    })\n}\n\nfunction triggerAppChange(appMayNotBeMountedYet) {\n    let newApp = appForCurrentURL();\n    if (!newApp) {\n        unhandledRouteHandlers.forEach((handler) => {\n            handler(mountedApp);\n        });\n        //nothing to do. Leave the app how it was\n        if (!appMayNotBeMountedYet)\n            console.warn(`No app matches the url ${window.location.toString()}, and there are no unhandledRouteHandlers`);\n        return;\n    }\n\n    if (newApp !== mountedApp) {\n        let oldApp = mountedApp;\n        let newAppHasBeenMountedBefore = !!newApp.scriptsLoaded;\n\n        (oldApp ? callLifecycleFunction(oldApp, 'applicationWillUnmount') : new Promise((resolve) => resolve()))\n        .then(() => cleanupDom())\n        .then(() => finishUnmountingApp(oldApp))\n        .then(() => (oldApp ? callLifecycleFunction(oldApp, 'applicationWasUnmounted') : new Promise((resolve) => resolve())))\n        .then(() => mountedApp = newApp)\n        .then(() => (newAppHasBeenMountedBefore ? new Promise((resolve) => resolve()) : setupApp(newApp.appLocation)))\n        .then(() => updateBaseTag(newApp.publicRoot))\n        .then(() => appWillBeMounted(newApp))\n        .then(() => insertDomFrom(newApp, !newAppHasBeenMountedBefore))\n        .catch((ex) => {\n            throw ex;\n        })\n    }\n}\n\nfunction updateBaseTag(newBaseHref) {\n    return new Promise((resolve) => {\n        if (document.baseURI === `${window.location.protocol}//` + `${window.location.hostname}:${window.location.port}${newBaseHref}`) {\n            debugger;\n            resolve();\n        } else {\n            newBaseHref = `/${newBaseHref}/`.replace(/[\\/]+/g, '/');\n            let baseTags = document.querySelectorAll('base');\n            for (let i=0; i<baseTags.length; i++) {\n                baseTags[i].parentNode.removeChild(baseTags[i]);\n            }\n            let newBase = document.createElement('base');\n            newBase.setAttribute('href', newBaseHref);\n            document.head.appendChild(newBase);\n            resolve();\n        }\n    });\n}\n\nfunction cleanupDom() {\n    return new Promise((resolve) => {\n        while (document.documentElement.attributes.length > 0) {\n            document.documentElement.removeAttribute(document.documentElement.attributes[0].name);\n        }\n        let numHeadElsToSkip = 0;\n        while (document.head.childNodes.length > numHeadElsToSkip) {\n            if (document.head.childNodes[numHeadElsToSkip].tagName !== 'BASE')\n                document.head.removeChild(document.head.childNodes[numHeadElsToSkip]);\n            else\n                numHeadElsToSkip++;\n        }\n        while (document.body.childNodes.length > 0) {\n            document.body.removeChild(document.body.childNodes[0]);\n        }\n        resolve();\n    })\n}\n\nfunction insertDomFrom(app, firstTime) {\n    return new Promise((resolve) => {\n        const deepClone = true;\n        const clonedAppDom = app.parsedDom.cloneNode(deepClone);\n        const appHead = clonedAppDom.querySelector('head');\n        const appBody = clonedAppDom.querySelector('body');\n\n        (firstTime ? callLifecycleFunction(app, 'scriptsWillBeLoaded') : new Promise((resolve) => resolve()))\n        .then(() => {\n            if (clonedAppDom.attributes) {\n                for (let i=0; i<clonedAppDom.attributes.length; i++) {\n                    const attr = clonedAppDom.attributes[i];\n                    document.documentElement.setAttribute(attr.name, attr.value);\n                }\n            }\n            resolve();\n        })\n        .then(() => (firstTime ? insertDomPreservingScriptExecutionOrder(document.head, appHead) : insertDomNoScripts(document.head, appHead)))\n        .then(firstTime ? (() => callLifecycleFunction(app, 'scriptsWereLoaded')) : new Promise((resolve) => resolve()))\n        .then(() => callLifecycleFunction(app, 'applicationWillMount'))\n        .then(() => (firstTime ? insertDomPreservingScriptExecutionOrder(document.body, appBody) : insertDomNoScripts(document.body, appBody)))\n        .then(() => {\n            return new Promise((resolve) => {\n                if (firstTime) {\n                    const event = document.createEvent('Event');\n                    event.initEvent('DOMContentLoaded', true, true);\n                    window.document.dispatchEvent(event);\n\n                    //we only load script tags once\n                    app.scriptsLoaded = true;\n                    const scripts = app.parsedDom.querySelectorAll('script');\n                    for (let i=0; i<scripts.length; i++) {\n                        scripts[i].remove();\n                    }\n                }\n                resolve();\n            });\n        })\n        .then(() => callLifecycleFunction(app, 'applicationWasMounted'))\n        .then(() => resolve())\n        .catch((ex) => {\n            throw ex;\n        });\n    });\n}\n\nfunction insertDomNoScripts(where, what) {\n    return new Promise((resolve) => {\n        while (what.childNodes.length > 0) {\n            where.appendChild(what.childNodes[0]);\n        }\n        resolve();\n    });\n}\n\nfunction insertDomPreservingScriptExecutionOrder(where, what) {\n    return new Promise((rootResolve) => {\n        //Time to get fancy -- we need to load scripts synchronously before proceeding to the next html element\n        iterateThroughNode();\n\n        function iterateThroughNode(index) {\n            if (what.childNodes.length > 0) {\n                traverseNode(where, what.childNodes[0])\n                .then(() => iterateThroughNode())\n                .catch((ex) => {\n                    throw ex;\n                });\n            } else {\n                rootResolve();\n            }\n        }\n\n        function traverseNode(domLocation, node) {\n            return new Promise((resolve) => {\n                /* 1. Append node without any of it's children\n                 * 2. Traverse the children one by one\n                 */\n\n                const children = [];\n                let nodeAppendedPromise;\n                let appendedNode;\n                if (node.tagName === 'SCRIPT') {\n                    //one does not simply append script tags\n                    nodeAppendedPromise = new Promise((resolve) => {\n                        const originalScriptTag = node;\n                        const scriptTag = document.createElement('script');\n                        for (let i=0; i<originalScriptTag.attributes.length; i++) {\n                            scriptTag.setAttribute(originalScriptTag.attributes[i].nodeName, originalScriptTag.getAttribute(originalScriptTag.attributes[i].nodeName));\n                        }\n                        if (!scriptTag.src) {\n                            scriptTag.text = originalScriptTag.text;\n                        }\n                        while (originalScriptTag.childNodes.length > 0) {\n                            originalScriptTag.removeChild(originalScriptTag.childNodes[0]);\n                        }\n                        originalScriptTag.remove();\n                        domLocation.appendChild(scriptTag);\n                        appendedNode = scriptTag;\n                        if (scriptTag.src && (!scriptTag.type || scriptTag.type === 'text/javascript')) {\n                            scriptTag.onload = () => {\n                                resolve();\n                            }\n                        } else {\n                            resolve();\n                        }\n                    });\n                } else {\n                    //remove the children\n                    while (node.childNodes.length > 0) {\n                        children.push(node.removeChild(node.childNodes[0]));\n                    }\n\n                    //append\n                    nodeAppendedPromise = new Promise((resolve) => {\n                        appendedNode = domLocation.appendChild(node);\n                        resolve();\n                    });\n                }\n\n                //traverse the children\n                nodeAppendedPromise\n                .then(() => traverseChildren())\n                .then(() => resolve())\n                .catch((ex) => {\n                    throw ex;\n                });\n\n                function traverseChildren() {\n                    return new Promise((resolve) => {\n                        traverseChild()\n                        function traverseChild() {\n                            if (children.length === 0) {\n                                resolve();\n                            } else {\n                                traverseNode(node, children.shift())\n                                .then(() => traverseChild(node, children))\n                                .catch((ex) => {\n                                    throw ex;\n                                });\n                            }\n                        }\n                    });\n                }\n            });\n        }\n    });\n}\n\nfunction setupApp(appLocation) {\n    return new Promise(function(resolve, reject) {\n        var currentAppSystemGlobal = window.System;\n        window.System = window.singlespa.loader;\n        window.singlespa.loader.import(appLocation).then(function(restOfApp) {\n            registerApplication(appLocation, restOfApp.publicRoot, restOfApp.pathToIndex, restOfApp.lifecycles);\n            let app = appLocationToApp[appLocation];\n            window.System = currentAppSystemGlobal;\n            loadIndex(app)\n            .then(() => resolve())\n            .catch((ex) => {\n                throw ex;\n            });\n        })\n        .catch((ex) => {\n            throw ex;\n        })\n    })\n}\n\nfunction loadIndex(app) {\n    return new Promise((resolve) => {\n        let request = new XMLHttpRequest();\n        request.addEventListener('load', htmlLoaded);\n        request.open('GET', `${window.location.protocol}//${window.location.hostname}:${window.location.port}` + `/${app.publicRoot}/${app.pathToIndex}`.replace(/\\/\\//g, '/'));\n        request.send();\n\n        function htmlLoaded() {\n            let parser = new DOMParser();\n            let dom = parser.parseFromString(this.responseText, 'text/html');\n\n            app.parsedDom = dom;\n            resolve();\n\n        }\n    });\n}\n\nfunction registerApplication(appLocation, publicRoot, pathToIndex, lifecycles) {\n    //validate\n    if (typeof publicRoot !== 'string') {\n        throw new Error(`App ${appLocation} must export a publicRoot string`);\n    }\n    if (typeof pathToIndex !== 'string') {\n        throw new Error(`App ${appLocation} must export a pathToIndex string`);\n    }\n    if (typeof lifecycles !== 'object' && typeof lifecycles !== 'function') {\n        throw new Error(`App ${appLocation} must export a 'lifecycles' object or array of objects`);\n    }\n    if (!Array.isArray(lifecycles)) {\n        lifecycles = [lifecycles];\n    }\n\n    //register\n    let app = appLocationToApp[appLocation];\n    app.publicRoot = publicRoot;\n    app.pathToIndex = pathToIndex;\n    app.windowEventListeners = {};\n    app.lifecycles = lifecycles;\n}\n\nfunction appForCurrentURL() {\n    let appsForCurrentUrl = [];\n    for (let appName in appLocationToApp) {\n        let app = appLocationToApp[appName];\n        if (app.activeWhen(window.location)) {\n            appsForCurrentUrl.push(app);\n        }\n    }\n    switch (appsForCurrentUrl.length) {\n        case 0:\n            return undefined;\n        case 1:\n            return appsForCurrentUrl[0];\n        default:\n            appNames = appsForCurrentUrl.map((app) => app.name);\n        throw new Error(`The following applications all claim to own the location ${window.location.href} -- ${appNames.toString()}`)\n    }\n}\n\nfunction appWillBeMounted(app) {\n    return new Promise((resolve) => {\n        for (let eventName in app.windowEventListeners) {\n            for (let i=0; i<app.windowEventListeners[eventName].length; i++)\n                nativeAddEventListener(eventName, app.windowEventListeners[eventName][i]);\n        }\n        resolve();\n    })\n}\n\nfunction finishUnmountingApp(app) {\n    return new Promise((resolve) => {\n        if (app) {\n            for (let eventName in app.windowEventListeners) {\n                for (let i=0; i<app.windowEventListeners[eventName].length; i++)\n                    window.removeEventListener(eventName, app.windowEventListeners[eventName][i]);\n            }\n        }\n        resolve();\n    })\n}\n\nwindow.addEventListener = function(name, fn) {\n    if (mountedApp) {\n        if (!mountedApp.windowEventListeners[name]) {\n            mountedApp.windowEventListeners[name] = [];\n        }\n        mountedApp.windowEventListeners[name].push(fn);\n    }\n    nativeAddEventListener.apply(this, arguments);\n}\n\nconst anchorAddedObserver = new MutationObserver(function(mutations) {\n    //my guess is that it is faster just to do one querySelectorAll instead of iterating through the mutations\n    const links = document.querySelectorAll('a');\n    for (let i=0; i<links.length; i++) {\n        const a = links[i];\n        if (!a.singlespa) {\n            a.singlespa = true;\n            a.addEventListener('click', anchorClicked);\n        }\n    }\n});\n\nanchorAddedObserver.observe(document, {\n    subtree: true,\n    childList: true,\n    characterData: true,\n});\n\nfunction anchorClicked(event) {\n    if (this.getAttribute('href') && this.getAttribute('href').indexOf('#') === 0) {\n        //the browser will prepend the href with whatever is in the <base> tag, which is not desirable\n        window.location.hash = this.getAttribute('href');\n        event.preventDefault();\n    } else {\n        const externalLink = window.location.host !== this.host || window.location.protocol !== this.protocol;\n        if (externalLink) {\n            //do the default thing\n            return;\n        } else {\n            //change the url\n            window.history.pushState(undefined, '', this.href);\n            //check if that means that we need to change the app\n            const appNeedsToChange = appForCurrentURL() !== mountedApp;\n            if (!appNeedsToChange) {\n                //do the default thing\n                return;\n            } else {\n                //only preventDefault when we're sure that single-spa is the sole handler of this event\n                event.preventDefault();\n                setTimeout(() => triggerAppChange(), 2);\n            }\n\n        }\n    }\n}\n"]}